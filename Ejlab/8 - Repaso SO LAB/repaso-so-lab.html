<?xml version="1.0" encoding="utf8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="es" lang="es">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf8" />
<meta name="generator" content="Docutils 0.14: http://docutils.sourceforge.net/" />
<title>SO - Práctica 8: Repaso SO LAB</title>
<style type="text/css">

/* Minimal style sheet for the HTML output of Docutils.                    */
/*                                                                         */
/* :Author: Günter Milde, based on html4css1.css by David Goodger          */
/* :Id: $Id: minimal.css 8036 2017-02-14 13:05:46Z milde $               */
/* :Copyright: © 2015 Günter Milde.                                        */
/* :License: Released under the terms of the `2-Clause BSD license`_,      */
/*    in short:                                                            */
/*                                                                         */
/*    Copying and distribution of this file, with or without modification, */
/*    are permitted in any medium without royalty provided the copyright   */
/*    notice and this notice are preserved.                                */
/*                                                                         */
/*    This file is offered as-is, without any warranty.                    */
/*                                                                         */
/* .. _2-Clause BSD license: http://www.spdx.org/licenses/BSD-2-Clause     */

/* This CSS2.1_ stylesheet defines rules for Docutils elements without    */
/* HTML equivalent. It is required to make the document semantic visible. */
/*                                                                        */
/* .. _CSS2.1: http://www.w3.org/TR/CSS2                                  */
/* .. _validates: http://jigsaw.w3.org/css-validator/validator$link       */

/* alignment of text and inline objects inside block objects*/
.align-left   { text-align: left; }
.align-right  { text-align: right; }
.align-center { clear: both; text-align: center; }
.align-top    { vertical-align: top; }
.align-middle { vertical-align: middle; }
.align-bottom { vertical-align: bottom; }

/* titles */
h1.title, p.subtitle {
  text-align: center;
}
p.admonition-title,
p.topic-title,
p.sidebar-title,
p.rubric,
p.system-message-title {
  font-weight: bold;
}
h1 + p.subtitle,
h1 + p.section-subtitle {
  font-size: 1.6em;
}
h2 + p.section-subtitle { font-size: 1.28em; }
p.subtitle,
p.section-subtitle,
p.sidebar-subtitle {
  font-weight: bold;
  margin-top: -0.5em;
}
p.sidebar-title,
p.rubric {
  font-size: larger;
}
p.rubric { color: maroon; }
a.toc-backref {
  color: black;
  text-decoration: none; }

/* Warnings, Errors */
div.caution p.admonition-title,
div.attention p.admonition-title,
div.danger p.admonition-title,
div.error p.admonition-title,
div.warning p.admonition-title,
div.system-messages h1,
div.error,
span.problematic,
p.system-message-title {
  color: red;
}

/* inline literals */
span.docutils.literal {
  font-family: monospace;
  white-space: pre-wrap;
}
/* do not wraph at hyphens and similar: */
.literal > span.pre { white-space: nowrap; }

/* Lists */

/* compact and simple lists: no margin between items */
.simple  li, .compact li,
.simple  ul, .compact ul,
.simple  ol, .compact ol,
.simple > li p, .compact > li p,
dl.simple > dd, dl.compact > dd {
  margin-top: 0;
  margin-bottom: 0;
}

/* Table of Contents */
div.topic.contents { margin: 0; }
ul.auto-toc {
  list-style-type: none;
  padding-left: 1.5em; }

/* Enumerated Lists */
ol.arabic     { list-style: decimal }
ol.loweralpha { list-style: lower-alpha }
ol.upperalpha { list-style: upper-alpha }
ol.lowerroman { list-style: lower-roman }
ol.upperroman { list-style: upper-roman }

dt span.classifier { font-style: italic }
dt span.classifier:before {
  font-style: normal;
  margin: 0.5em;
  content: ":";
}

/* Field Lists and drivatives */
/* bold field name, content starts on the same line */
dl.field-list > dt,
dl.option-list > dt,
dl.docinfo > dt,
dl.footnote > dt,
dl.citation > dt {
  font-weight: bold;
  clear: left;
  float: left;
  margin: 0;
  padding: 0;
  padding-right: 0.5em;
}
/* Offset for field content (corresponds to the --field-name-limit option) */
dl.field-list > dd,
dl.option-list > dd,
dl.docinfo > dd {
  margin-left:  9em; /* ca. 14 chars in the test examples */
}
/* start field-body on a new line after long field names */
dl.field-list > dd > *:first-child,
dl.option-list > dd > *:first-child
{
  display: inline-block;
  width: 100%;
  margin: 0;
}
/* field names followed by a colon */
dl.field-list > dt:after,
dl.docinfo > dt:after {
  content: ":";
}

/* Bibliographic Fields (docinfo) */
pre.address { font: inherit; }
dd.authors > p { margin: 0; }

/* Option Lists */
dl.option-list { margin-left: 40px; }
dl.option-list > dt { font-weight: normal; }
span.option { white-space: nowrap; }

/* Footnotes and Citations  */
dl.footnote.superscript > dd {margin-left: 1em; }
dl.footnote.brackets > dd {margin-left: 2em; }
dl > dt.label { font-weight: normal; }
a.footnote-reference.brackets:before,
dt.label > span.brackets:before { content: "["; }
a.footnote-reference.brackets:after,
dt.label > span.brackets:after { content: "]"; }
a.footnote-reference.superscript,
dl.footnote.superscript > dt.label {
  vertical-align: super;
  font-size: smaller;
}
dt.label > span.fn-backref { margin-left: 0.2em; }
dt.label > span.fn-backref > a { font-style: italic; }

/* Line Blocks */
div.line-block { display: block; }
div.line-block div.line-block {
  margin-top: 0;
  margin-bottom: 0;
  margin-left: 40px;
}

/* Figures, Images, and Tables */
.figure.align-left,
img.align-left,
object.align-left,
table.align-left {
  margin-right: auto;
}
.figure.align-center,
img.align-center,
object.align-center {
  margin-left: auto;
  margin-right: auto;
  display: block;
}
table.align-center {
  margin-left: auto;
  margin-right: auto;
}
.figure.align-right,
img.align-right,
object.align-right,
table.align-right {
  margin-left: auto;
}
/* reset inner alignment in figures and tables */
/* div.align-left, div.align-center, div.align-right, */
table.align-left, table.align-center, table.align-right
{ text-align: inherit }

/* Admonitions and System Messages */
div.admonition,
div.system-message,
div.sidebar{
  margin: 40px;
  border: medium outset;
  padding-right: 1em;
  padding-left: 1em;
}

/* Sidebar */
div.sidebar {
  width: 30%;
  max-width: 26em;
  float: right;
  clear: right;
}

/* Text Blocks */
div.topic,
pre.literal-block,
pre.doctest-block,
pre.math,
pre.code {
  margin-right: 40px;
  margin-left: 40px;
}
pre.code .ln { color: gray; } /* line numbers */

/* Tables */
table { border-collapse: collapse; }
td, th {
  border-style: solid;
  border-color: silver;
  padding: 0 1ex;
  border-width: thin;
}
td > p:first-child, th > p:first-child { margin-top: 0; }
td > p, th > p { margin-bottom: 0; }

table > caption {
  text-align: left;
  margin-bottom: 0.25em
}

table.borderless td, table.borderless th {
  border: 0;
  padding: 0;
  padding-right: 0.5em /* separate table cells */
}

</style>
<style type="text/css">

/* CSS31_ style sheet for the output of Docutils HTML writers.             */
/* Rules for easy reading and pre-defined style variants.		   */
/*                                                                         */
/* :Author: Günter Milde, based on html4css1.css by David Goodger          */
/* :Id: $Id: plain.css 8120 2017-06-22 21:02:40Z milde $               */
/* :Copyright: © 2015 Günter Milde.                                        */
/* :License: Released under the terms of the `2-Clause BSD license`_,      */
/*    in short:                                                            */
/*                                                                         */
/*    Copying and distribution of this file, with or without modification, */
/*    are permitted in any medium without royalty provided the copyright   */
/*    notice and this notice are preserved.                                */
/*    	     	      	     	 					   */
/*    This file is offered as-is, without any warranty.                    */
/*                                                                         */
/* .. _2-Clause BSD license: http://www.spdx.org/licenses/BSD-2-Clause     */
/* .. _CSS3: http://www.w3.org/TR/CSS3		        		   */


/* Document Structure */
/* ****************** */

/* "page layout" */
body {
  padding: 0 5%;
  margin: 8px 0;
}
div.document {
  line-height:1.3;
  counter-reset: table;
  /* counter-reset: figure; */
  /* avoid long lines --> better reading */
  /* OTOH: lines should not be too short because of missing hyphenation, */
  max-width: 50em;
  margin: auto;
}

/* Sections */

/* Transitions */

hr.docutils {
  width: 80%;
  margin-top: 1em;
  margin-bottom: 1em;
  clear: both;
}

/* Paragraphs               */
/* ==========               */

/* vertical space (parskip) */
p, ol, ul, dl,
div.line-block,
table{
  margin-top: 0.5em;
  margin-bottom: 0.5em;
}
h1, h2, h3, h4, h5, h6,
dl > dd {
  margin-bottom: 0.5em;
}

/* Lists                    */
/* ==========               */

/* Definition Lists         */

dl > dd > p:first-child { margin-top: 0; }
/* :last-child is not part of CSS 2.1 (introduced in CSS 3) */
dl > dd > p:last-child  { margin-bottom: 0; }

/* lists nested in definition lists */
/* :only-child is not part of CSS 2.1 (introduced in CSS 3) */
dd > ul:only-child, dd > ol:only-child { padding-left: 1em; }

/* Description Lists */
/* styled like in most dictionaries, encyclopedias etc. */
dl.description > dt {
  font-weight: bold;
  clear: left;
  float: left;
  margin: 0;
  padding: 0;
  padding-right: 0.5em;
}

/* Field Lists */

/* example for custom field-name width */
dl.field-list.narrow > dd {
  margin-left: 5em;
}
/* run-in: start field-body on same line after long field names */
dl.field-list.run-in > dd p {
  display: block;
}

/* Bibliographic Fields */

/* generally, bibliographic fields use special definition list dl.docinfo */
/* but dedication and abstract are placed into "topic" divs */
div.abstract p.topic-title {
  text-align: center;
}
div.dedication {
  margin: 2em 5em;
  text-align: center;
  font-style: italic;
}
div.dedication p.topic-title {
  font-style: normal;
}

/* Citations */
dl.citation dt.label {
  font-weight: bold;
}
span.fn-backref {
  font-weight: normal;
}

/* Text Blocks           */
/* ============          */

/* Literal Blocks           */
pre.literal-block, pre.doctest-block,
pre.math, pre.code {
  margin-left: 1.5em;
  margin-right: 1.5em
}

/* Block Quotes             */

blockquote,
div.topic {
  margin-left: 1.5em;
  margin-right: 1.5em
}
blockquote > table,
div.topic > table {
  margin-top: 0;
  margin-bottom: 0;
}
blockquote p.attribution,
div.topic p.attribution {
  text-align: right;
  margin-left: 20%;
}

/* Tables                   */
/* ======                   */

/* th { vertical-align: bottom; } */

table tr { text-align: left; }

/* "booktabs" style (no vertical lines) */
table.booktabs {
  border: 0;
  border-top: 2px solid;
  border-bottom: 2px solid;
  border-collapse: collapse;
}
table.booktabs * {
  border: 0;
}
table.booktabs th {
  border-bottom: thin solid;
}

/* numbered tables (counter defined in div.document) */
table.numbered > caption:before {
  counter-increment: table;
  content: "Table " counter(table) ": ";
  font-weight: bold;
}

/* Explicit Markup Blocks   */
/* ======================   */

/* Footnotes and Citations  */
/* -----------------------  */

/* line on the left */
dl.footnote {
  padding-left: 1ex;
  border-left: solid;
  border-left-width: thin;
}

/* Directives               */
/* ----------               */

/* Body Elements            */
/* ~~~~~~~~~~~~~            */

/* Images and Figures */

/* let content flow to the side of aligned images and figures */
.figure.align-left,
img.align-left,
object.align-left {
  display: block;
  clear: left;
  float: left;
  margin-right: 1em
}
.figure.align-right,
img.align-right,
object.align-right {
  display: block;
  clear: right;
  float: right;
  margin-left: 1em
}
/* Stop floating sidebars, images and figures at section level 1,2,3 */
h1, h2, h3 { clear: both; }

/* Sidebar */

/* Move into the margin. In a layout with fixed margins, */
/* it can be moved into the margin completely.		 */
div.sidebar {
  width: 30%;
  max-width: 26em;
  margin-left: 1em;
  margin-right: -5.5%;
  background-color: #ffffee ;
}

/* Code                     */

pre.code, code { background-color: #eeeeee }
pre.code .ln { color: gray; } /* line numbers */
/* basic highlighting: for a complete scheme, see */
/* http://docutils.sourceforge.net/sandbox/stylesheets/ */
pre.code .comment, code .comment { color: #5C6576 }
pre.code .keyword, code .keyword { color: #3B0D06; font-weight: bold }
pre.code .literal.string, code .literal.string { color: #0C5404 }
pre.code .name.builtin, code .name.builtin { color: #352B84 }
pre.code .deleted, code .deleted { background-color: #DEB0A1}
pre.code .inserted, code .inserted { background-color: #A3D289}

/* Math                     */
/* styled separately (see math.css for math-output=HTML) */

/* Epigraph                 */
/* Highlights               */
/* Pull-Quote               */
/* Compound Paragraph       */
/* Container                */

/* can be styled in a custom stylesheet */

/* Document Header and Footer */

div.footer, div.header {
  clear: both;
  font-size: smaller;
}

/* Inline Markup            */
/* =============            */

/* Emphasis                 */
/*   em                     */
/* Strong Emphasis          */
/*   strong		    */
/* Interpreted Text         */
/*   span.interpreted  	    */
/* Title Reference 	    */
/*   cite		    */
/* Inline Literals          */
/* possible values: normal, nowrap, pre, pre-wrap, pre-line */
/*   span.docutils.literal { white-space: pre-wrap; } */

/* Hyperlink References     */
a { text-decoration: none; }

/* External Targets         */
/*   span.target.external   */
/* Internal Targets  	    */
/*   span.target.internal   */
/* Footnote References      */
/*   a.footnote-reference   */
/* Citation References      */
/*   a.citation-reference   */

</style>
<style type="text/css">

:root {
    /* HSLA: hue, saturation, lightness, alpha */
        /* hue: degree on the color wheel (0-360), 0 is red, 120 green, 240 blue */
        /* saturation: 0% shade of grey - 100% full color */
        /* lightness: 0% black - 100% white */
        /* alpha: opacity 0.0 fully transparent - 1.0 fully opaque */
    /* Elijo hue y saturation */
        /* lightness para los diferentes elementos */
        /* para los a-visited me ha ido bien bajar el lightness (lo oscurece) */
        /* opacity lo veo bien para el background */

    /* #708090 rgb(112, 128, 144) hsl(210, 13%, 50%) SlateGray */
    /* Usar el modo bloque de Kate cambiar el color base */

    --color-h1-title:                    hsl(210, 13%, 20%, 1.0);
    --color-a-link:                      hsl(210, 13%, 25%, 1.0);
    --color-a-hover-active:              hsl(210, 13%, 75%, 1.0);
    --color-a-visited:                   hsl(210, 30%, 50%, 1.0);
    --color-background:                  hsl(210, 13%, 20%, 0.5);
    --color-admonition-title-background: hsl(210, 13%, 86%, 1.0);
    --color-body:                        dimgray;
    --color-body-background:             whitesmoke;
    --color-document-background:         whitesmoke;
    --color-main-background:             whitesmoke;
}

body {
    color: var(--color-body);
    background-color: var(--color-body-background);
    text-align: justify;
    margin: 0;
    padding: 1%;
    padding-top: 3%;
    padding-bottom: 3%;
}
div.document, main {
    line-height: normal;
    margin: auto;
    padding: 3%;
    max-width: 55em;
    background-color: var(--color-document-background);
    box-shadow: 0em 0em 0.5em 0.1em gray;
}
main {
    background-color: var(--color-main-background);
}
h1.title {
    font-size: 300%;
    color: var(--color-h1-title);
    text-shadow: 0.1em 0.1em 0.2em gray; 
    text-align: center;
}
h2.subtitle {
    text-align: center;
}
a:link, a:visited {
    color: var(--color-a-link);
    text-decoration: none;
    text-shadow: 0.05em 0.05em 0.1em gray;
}
a:visited {
    color: var(--color-a-visited);
}
a:hover, a:active { 
    color: var(--color-a-hover-active);
    text-decoration: none;
}
.caption {
    font-size: 90%;
    font-style: oblique;
}
div.admonition {
    border: none;
    padding: 0.75em;
    box-shadow: 0.05em 0.05em 0.1em 0.1em gray;
}    
.admonition-title {
    text-align: center;
    background-color: var(--color-admonition-title-background);
/*     border-bottom: thin solid; */
    margin-left: 10%;
    margin-right: 10%;
    margin-bottom: 1em;
}
/* permite wrapping respetando los espacios */
pre.literal-block {
    white-space: pre-wrap;
}

</style>
<style type="text/css">


:root {
    /* HSLA: hue, saturation, lightness, alpha */
        /* hue: degree on the color wheel (0-360), 0 is red, 120 green, 240 blue */
        /* saturation: 0% shade of grey - 100% full color */
        /* lightness: 0% black - 100% white */
        /* alpha: opacity 0.0 fully transparent - 1.0 fully opaque */
    /* Elijo hue y saturation */
        /* lightness para los diferentes elementos */
        /* para los a-visited me ha ido bien bajar el lightness (lo oscurece) */
        /* opacity lo veo bien para el background */

    /* #a0522d rgb(62.75, 32.16, 17.65) hsl(19, 56, 40) Sienna */
    /* Usar el modo bloque de Kate cambiar el color base */

    --color-h1-title:                    hsl(19, 56%, 40%, 1.0);
    --color-a-link:                      hsl(19, 56%, 40%, 1.0);
    --color-a-hover-active:              hsl(19, 56%, 51%, 1.0);
    --color-a-visited:                   hsl(19, 26%, 26%, 1.0);
    --color-background:                  hsl(19, 56%, 40%, 0.5);
    --color-admonition-title-background: hsl(19, 56%, 86%, 1.0);

}

body {
    background-color: var(--color-background);
}
h1, h2, h3, h4, h5, h6 {
    text-align: left;
}
h1.title {
    color: var(--color-h1-title);
}
a:link, a:visited {
    color: var(--color-a-link);
    text-decoration: underline;
    text-decoration-style: dotted;
    text-shadow: none;
}
a:visited {
    color: var(--color-a-visited);
}
a:hover, a:active {
    color: var(--color-a-hover-active);
}
.admonition-title {
    background-color: var(--color-admonition-title-background);
}

</style>
</head>
<body>
<div class="document" id="so-practica-8-repaso-so-lab">
<h1 class="title">SO - Práctica 8: Repaso SO LAB</h1>
<h2 class="subtitle" id="today">24 de abril de 2023</h2>

<div class="contents topic" id="contenido">
<p class="topic-title first">Contenido</p>
<ul class="simple">
<li><a class="reference internal" href="#objetivos" id="id1">Objetivos</a><ul>
<li><a class="reference internal" href="#caso-de-ejemplo-extc" id="id2">Caso de ejemplo: &quot;extc&quot;</a></li>
</ul>
</li>
<li><a class="reference internal" href="#trabajo-previo-a-la-sesion-de-laboratorio" id="id3">Trabajo previo a la sesión de laboratorio</a></li>
<li><a class="reference internal" href="#preparando-la-maquina-virtual-extc" id="id4">Preparando la máquina virtual &quot;extc&quot;</a><ul>
<li><a class="reference internal" href="#ejercicio-previo-1-preparando-extc" id="id5">Ejercicio previo 1: preparando &quot;extc&quot;</a></li>
</ul>
</li>
<li><a class="reference internal" href="#primeros-pasos-con-rsync" id="id6">Primeros pasos con &quot;rsync&quot;</a><ul>
<li><a class="reference internal" href="#ejercicio-previo-2-jugando-con-rsync" id="id7">Ejercicio previo 2: jugando con &quot;rsync&quot;</a></li>
</ul>
</li>
<li><a class="reference internal" href="#programando-un-script-para-realizar-pruebas-con-datos-simulados" id="id8">Programando un <em>script</em> para realizar pruebas con datos simulados</a><ul>
<li><a class="reference internal" href="#ejercicio-previo-3-script-para-preparar-datos-de-prueba" id="id9">Ejercicio previo 3: <em>script</em> para preparar datos de prueba</a></li>
</ul>
</li>
<li><a class="reference internal" href="#anadiendo-discos-a-extc" id="id10">Añadiendo discos a &quot;extc&quot;</a><ul>
<li><a class="reference internal" href="#ejercicio-1-instalando-los-discos" id="id11">Ejercicio 1: Instalando los discos</a></li>
</ul>
</li>
<li><a class="reference internal" href="#trasladando-el-sf-home" id="id12">Trasladando el SF &quot;/home&quot;</a><ul>
<li><a class="reference internal" href="#ejercicio-2-trasladando-home" id="id13">Ejercicio 2: Trasladando &quot;/home&quot;</a></li>
</ul>
</li>
<li><a class="reference internal" href="#preparando-el-sf-para-datos" id="id14">Preparando el SF para datos</a><ul>
<li><a class="reference internal" href="#ejercicio-3-preparando-data" id="id15">Ejercicio 3: Preparando &quot;data&quot;</a></li>
</ul>
</li>
<li><a class="reference internal" href="#jugando-con-datos-y-copias-de-seguridad" id="id16">Jugando con datos y copias de seguridad</a><ul>
<li><a class="reference internal" href="#ejercicio-4-probando-mas-cosas-con-rsync" id="id17">Ejercicio 4: probando más cosas con &quot;rsync&quot;</a></li>
<li><a class="reference internal" href="#ejercicio-opcional-1-usando-snapshots" id="id18">Ejercicio opcional 1: usando <em>snapshots</em></a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="objetivos">
<h1><a class="toc-backref" href="#id1">Objetivos</a></h1>
<blockquote>
<ul class="simple">
<li>Reforzar el aprendizaje de varios aspectos del laboratorio de la asignatura, con especial énfasis en la administración de sistemas y el manejo del intérprete de órdenes.</li>
<li>Favorecer el trabajo autónomo del alumnado. (Por este motivo, las instrucciones de esta práctica son, intencionadamente, menos detalladas que en prácticas anteriores. En caso de necesidad se recomienda recurrir a las anotaciones personales y a los enunciados de dichas prácticas).</li>
<li>Plantear un caso realista. (Se describe a continuación).</li>
</ul>
</blockquote>
<div class="section" id="caso-de-ejemplo-extc">
<h2><a class="toc-backref" href="#id2">Caso de ejemplo: &quot;extc&quot;</a></h2>
<p>Vamos a suponer que &quot;extc&quot; es un ordenador personal utilizado por User One (&quot;user1&quot;). El sistema operativo fue instalado en su momento sin utilizar volúmenes lógicos y el sistema de ficheros &quot;/home&quot; está a punto de llenarse. Además, se va a comenzar a trabajar en un proyecto nuevo que va a requerir el almacenamiento de una gran cantidad de datos.</p>
<p>Tras analizar el uso previsto de &quot;extc&quot;, se han tomado las siguientes decisiones:</p>
<blockquote>
<ul class="simple">
<li>Adquirir 3 discos SCSI de 100 GB cada uno y configurarlos como un único volúmen físico (PV).</li>
<li>Crear un volumen lógico denominado &quot;lv_home&quot; que tendrá inicialmente 50 GB y que alojará el SF &quot;/home&quot;.</li>
<li>Crear otro volumen lógico denominado &quot;lv_data&quot;, que usará el resto del espacio del PV y que alojará el SF &quot;/mnt/data&quot;.</li>
<li>Adquirir un cuarto disco SCSI de 500 GB para poder realizar copias de seguridad de los datos.</li>
</ul>
</blockquote>
</div>
</div>
<div class="section" id="trabajo-previo-a-la-sesion-de-laboratorio">
<h1><a class="toc-backref" href="#id3">Trabajo previo a la sesión de laboratorio</a></h1>
<p>El alumnado, antes de asistir a la sesión de laboratorio, debe:</p>
<blockquote>
<ul class="simple">
<li>Repasar las prácticas anteriores, especialmente las relacionadas con el intérprete de órdenes y la administración del sistema.</li>
<li>Realizar los ejercicios etiquetados como &quot;Ejercicio previo&quot;.</li>
</ul>
</blockquote>
<div class="admonition admonition-material-a-entregar">
<p class="first admonition-title">Material a entregar</p>
<ul class="last simple">
<li>Material solicitado en los ejercicios marcados como &quot;Ejercicio previo...&quot;.</li>
</ul>
</div>
</div>
<div class="section" id="preparando-la-maquina-virtual-extc">
<h1><a class="toc-backref" href="#id4">Preparando la máquina virtual &quot;extc&quot;</a></h1>
<p>En esta práctica también se va a utilizar la máquina virtual &quot;extc&quot; de NETinVM y se va a trabajar como administrador del sistema.</p>
<p>Para evitar heredar problemas causados por las actividades realizadas durante la práctica anterior es necesario, antes de nada, restaurar la copia de seguridad etiquetada como &quot;initial&quot;. Y también, si todavía no se ha hecho, eliminar los discos adicionales que pudiera tener configurados &quot;extc&quot;. (Sugerencia: usar &quot;virsh domblklist&quot; y &quot;<a class="reference external" href="src/so-remove-disks.sh">so-remove-disks.sh</a>&quot;).</p>
<div class="section" id="ejercicio-previo-1-preparando-extc">
<h2><a class="toc-backref" href="#id5">Ejercicio previo 1: preparando &quot;extc&quot;</a></h2>
<p>Restaurar la copia de seguridad &quot;initial&quot; e instalar los paquetes necesarios.</p>
<div class="admonition admonition-tareas-a-realizar">
<p class="first admonition-title">Tareas a realizar</p>
<ol class="last arabic simple">
<li>Restaurar la copia de seguridad &quot;initial&quot;.</li>
<li>Si es necesario, eliminar los discos adicionales de la práctica 7.</li>
<li>Arrancar &quot;extc&quot; e instalar los paquetes &quot;lvm2&quot; y &quot;thin-provisioning-tools&quot;.</li>
<li>Comprobar que están instalados los programas de gestión de LV.</li>
<li>Comprobar que que no aparecen discos adicionales.</li>
<li>Apagar &quot;extc&quot; y crear una copia de seguridad etiquetada como &quot;so-lab8-ejprev1&quot;.</li>
</ol>
</div>
<div class="admonition admonition-material-a-entregar">
<p class="first admonition-title">Material a entregar</p>
<ul class="last simple">
<li>Salida de la orden &quot;lvmdiskscan&quot;. (En &quot;extc&quot;, como &quot;root&quot;).</li>
</ul>
</div>
</div>
</div>
<div class="section" id="primeros-pasos-con-rsync">
<h1><a class="toc-backref" href="#id6">Primeros pasos con &quot;rsync&quot;</a></h1>
<div class="admonition warning">
<p class="first admonition-title">Advertencia</p>
<ul class="last simple">
<li>Los ejemplos de este apartado están pensados para ser ejecutados como &quot;root&quot;.</li>
<li>El directorio &quot;/mnt/copias-de-seguridad&quot; no existe en &quot;extc&quot;, así que será necesario crearlo antes empezar a probar cosas.</li>
<li>La orden &quot;diff -rb --no-dereference /etc /mnt/copias-de-seguridad/etc&quot; sirve para comprobar si hay diferencias entre los dos directorios indicados, así que puede ser una buena herramienta para comprobar el funcionamiento de &quot;rsync&quot;.</li>
</ul>
</div>
<p>El programa &quot;rsync&quot; es una herramienta rápida y versátil que permite copiar ficheros tanto local como remotamente. La principal ventaja es que compara los ficheros y directorios de origen y de destino y solamente transfiere las diferencias entre ellos. Por ejemplo, si se hace una copia del directorio &quot;/etc&quot; en la carpeta &quot;/mnt/copias-de-seguridad&quot;:</p>
<pre class="code literal-block">
rsync -av /etc /mnt/copias-de-seguridad
</pre>
<p>la primera vez &quot;rsync&quot; copia todos los ficheros y directorios recursivamente; pero, y aquí es donde brilla, si más tarde se vuelve a ejecutar la misma orden solamente se copiarán los cambios. Una forma sencilla de comprobarlo es crear en &quot;/etc&quot; un fichero de texto sencillo e ir haciendo diversas modificaciones sobre él.</p>
<div class="admonition note">
<p class="first admonition-title">Nota</p>
<p>Aunque no se va a usar en esta práctica, &quot;rsync&quot; permite hacer copias remotas. Por ejemplo, para copiar el directorio local &quot;/etc&quot; en el directorio &quot;/mnt/copias-de-seguridad&quot; de la máquina &quot;server1&quot; se usaría la orden:</p>
<pre class="code literal-block">
rsync -av /etc server1:/mnt/copias-de-seguridad
</pre>
<p class="last">En este caso &quot;rsync&quot; puede usar un servidor de RSYNC instalado en la máquina o puede utilizar una conexión SSH (se estudia en las asignaturas de redes y seguridad).</p>
</div>
<p>Siguiendo con el trabajo en local, &quot;rsync&quot; tiene muchas opciones interesantes. Para conocerlas es conveniente leer su página del manual. Un buen punto de partida es averiguar para qué sirven las opciones 'a' y 'v', que se han utilizado en los ejemplos anteriores. Otra opción interesante, que se utilizará en la sesión presencial, es &quot;--exclude&quot;, que permite excluir ciertos ficheros y/o directorios.</p>
<p>Otra a cosa a tener en cuenta es que &quot;rsync&quot; también sirve para deshacer los cambios de forma eficiente. Por ejemplo, supongamos que tras realizar una copia de &quot;/etc&quot; en el directorio &quot;/mnt/copias-de-seguridad&quot;, usando &quot;rsync -a /etc /mnt/copias-de-seguridad&quot;, se ha cometido un error al modificar algunos ficheros y/o directorios contenidos en &quot;/etc&quot;. Pues bien, para deshacer los cambios, lo único que habría que hacer es usar la copia de seguridad como origen:</p>
<pre class="code literal-block">
rsync -av /mnt/copias-de-seguridad/etc /
</pre>
<p>Por último, si se desea averiguar qué ha cambiado desde la última copia de seguridad, simplemente habría que añadir '-n' o '--dry-run' a las opciones:</p>
<pre class="code literal-block">
rsync -avn /etc /mnt/copias-de-seguridad
</pre>
<div class="section" id="ejercicio-previo-2-jugando-con-rsync">
<h2><a class="toc-backref" href="#id7">Ejercicio previo 2: jugando con &quot;rsync&quot;</a></h2>
<p>Leer la página del manual de &quot;rsync&quot; y familiarizarse con su estructura, probando diferentes formas de usar la orden hasta ser capaz de responder con confianza a las preguntas siguientes:</p>
<blockquote>
<ol class="arabic">
<li><p class="first">¿Qué diferencia hay entre estas dos órdenes?</p>
<pre class="code literal-block">
rsync -av /etc /mnt/bkup
rsync -av /etc/ /mnt/bkup
</pre>
</li>
<li><p class="first">¿Qué opción hay que usar para que &quot;rsync&quot; borre en la copia los ficheros y directorios que han sido borrados en el original?</p>
</li>
</ol>
</blockquote>
<div class="admonition admonition-tareas-a-realizar">
<p class="first admonition-title">Tareas a realizar</p>
<ul class="last simple">
<li>Responder a las preguntas planteadas. (Sugerencia: realizar diversas pruebas hasta tener claras la respuestas).</li>
</ul>
</div>
<div class="admonition admonition-material-a-entregar">
<p class="first admonition-title">Material a entregar</p>
<ul class="last simple">
<li>Respuestas a las preguntas planteas.</li>
</ul>
</div>
</div>
</div>
<div class="section" id="programando-un-script-para-realizar-pruebas-con-datos-simulados">
<h1><a class="toc-backref" href="#id8">Programando un <em>script</em> para realizar pruebas con datos simulados</a></h1>
<div class="admonition warning">
<p class="first admonition-title">Advertencia</p>
<p class="last">Los ejemplos y ejercicios de este apartado están pensados para ser ejecutados como &quot;user1&quot; en el entorno gráfico de &quot;extc&quot;. (En el documento &quot;<a class="reference external" href="https://aulavirtual.uv.es/mod/resource/view.php?id=1653189">Introducción a NETinVM</a>&quot; se explica cómo ponerlo en marcha).</p>
</div>
<div class="section" id="ejercicio-previo-3-script-para-preparar-datos-de-prueba">
<h2><a class="toc-backref" href="#id9">Ejercicio previo 3: <em>script</em> para preparar datos de prueba</a></h2>
<p>Tras leer la introducción al apartado &quot;<a class="reference internal" href="#jugando-con-datos-y-copias-de-seguridad">Jugando con datos y copias de seguridad</a>&quot;, realizar un <em>script</em> para el intérprete de órdenes <em>bash</em> que cree los directorios y ficheros indicados por un fichero CSV con el siguiente formato:</p>
<blockquote>
<ul class="simple">
<li>Cada línea es un registro con 3 campos: directorio, fichero, contenido para el fichero.</li>
<li>Los campos están separados entre sí por comas.</li>
<li>La primera línea es el encabezado.</li>
</ul>
</blockquote>
<p>El <em>script</em> debe funcionar de la siguiente forma:</p>
<blockquote>
<ul>
<li><p class="first">Debe crear los directorios en el directorio de trabajo.</p>
</li>
<li><p class="first">Debe leer el listado de la entrada estándar.</p>
</li>
<li><p class="first">Debe ignorar el encabezado.</p>
</li>
<li><p class="first">Para cada registro:</p>
<blockquote>
<ul class="simple">
<li>Si el directorio no existe todavía, debe crearlo. (Si existe no debe fallar).</li>
<li>Debe crear el fichero dentro del directorio indicado.</li>
<li>El fichero debe contener exactamente los datos indicados, sin añadir saltos de línea ni ningún otro carácter adicional.</li>
</ul>
</blockquote>
</li>
</ul>
</blockquote>
<p>Durante el desarrollo, se recomienda usar una versión reducida del listado. Por ejemplo:</p>
<pre class="literal-block">
user1&#64;extc:~/lab8$ ./genera_listado.py &gt;listado.txt
user1&#64;extc:~/lab8$ head -n 5 listado.txt &gt;listado_breve_5.txt
user1&#64;extc:~/lab8$ cat listado_breve_5.txt
directorio,fichero,contenido-del-fichero
particion,f0702,3db8153a98f7e3c4b918530f60f1cfdf735888caf985eb140754a72ebb398c6e
particion,f0877,0719ac2a5e68e816a56d561abd0bac34cd3ba59c3b4e7a1c6c22e306c8dd551b
particion,f0683,a9b767a3002b539e396c1f5ce187c6842e58c037063e4524ea85969730a4599d
particion,f0221,1aabe1602519ac9a8adc24fb2e13540924d4354cea78c54ddfde1b7698094f3c
user1&#64;extc:~/lab8$ mkdir pruebas
user1&#64;extc:~/lab8$ cd pruebas/
user1&#64;extc:~/lab8/pruebas$ ../procesa_listado.sh &lt; ../listado_breve_5.txt
user1&#64;extc:~/lab8/pruebas$ ls -l
total 4
drwxr-xr-x 2 user1 user1 4096 Apr 24 11:33 particion
user1&#64;extc:~/lab8/pruebas$ ls -l particion
total 16
-rw-r--r-- 1 user1 user1 64 Apr 24 11:33 f0221
-rw-r--r-- 1 user1 user1 64 Apr 24 11:33 f0683
-rw-r--r-- 1 user1 user1 64 Apr 24 11:33 f0702
-rw-r--r-- 1 user1 user1 64 Apr 24 11:33 f0877
user1&#64;extc:~/lab8/pruebas$ cat particion/f0221
1aabe1602519ac9a8adc24fb2e13540924d4354cea78c54ddfde1b7698094f3cuser1&#64;extc:~/lab8/pruebas$
</pre>
<p>Nótese que, como el fichero &quot;particion/f0221&quot; no incluye un salto de línea al final, el <em>prompt</em> de la <em>shell</em> aparece a continuación del contenido del fichero. Nótese también que todos los ficheros deben tener la misma longitud: 64 bytes.</p>
<p>Adicionalmente, cuando todo parezca correcto, se debe hacer una prueba con el verificador. Eso sí, el verificador solamente funciona con un listado completo (25 directorios y 100 ficheros por directorio). Para evitar arrastrar errores de pruebas anteriores, lo mejor es eliminar las pruebas previas y generar todo desde el principio:</p>
<pre class="literal-block">
user1&#64;extc:~/lab8/pruebas$ cd ..
user1&#64;extc:~/lab8$ rm -rf pruebas/
user1&#64;extc:~/lab8$ mkdir pruebas
user1&#64;extc:~/lab8$ cd pruebas/
user1&#64;extc:~/lab8/pruebas$ ../procesa_listado.sh &lt; ../listado.txt
user1&#64;extc:~/lab8/pruebas$ ../verifica_listado.sh &lt; ../listado.txt
Comprobación correcta de 2500 ficheros :-)
user1&#64;extc:~/lab8/pruebas$
</pre>
<div class="admonition note">
<p class="first admonition-title">Nota</p>
<ul class="last simple">
<li>Se ha supuesto que el <em>script</em> a desarrollar en este apartado ha sido denominado &quot;procesa_listado.sh&quot;.</li>
<li>Los programas &quot;<a class="reference external" href="src/genera_listado.py">genera_listado.py</a>&quot;, y &quot;<a class="reference external" href="src/verifica_listado.sh">verifica_listado.sh</a>&quot; están explicados en el apartado &quot;<a class="reference internal" href="#jugando-con-datos-y-copias-de-seguridad">Jugando con datos y copias de seguridad</a>&quot;.</li>
</ul>
</div>
<div class="admonition admonition-tareas-a-realizar">
<p class="first admonition-title">Tareas a realizar</p>
<ol class="last arabic simple">
<li>Desarrollar el <em>script</em> propuesto.</li>
<li>Comprobar que funciona correctamente.</li>
</ol>
</div>
<div class="admonition admonition-material-a-entregar">
<p class="first admonition-title">Material a entregar</p>
<ul class="last simple">
<li><em>Script</em> realizado.</li>
</ul>
</div>
</div>
</div>
<div class="section" id="anadiendo-discos-a-extc">
<h1><a class="toc-backref" href="#id10">Añadiendo discos a &quot;extc&quot;</a></h1>
<p>Una vez preparadas las herramientas necesarias (&quot;extc&quot;, &quot;rsync&quot; y los <em>scripts</em> para trabajar con datos simulados), es el momento de llevar a la práctica el caso realista planteado en &quot;<a class="reference internal" href="#caso-de-ejemplo-extc">Caso de ejemplo: &quot;extc&quot;</a>&quot;.</p>
<p>Lógicamente, el primer paso es instalar los discos en el sistema. En &quot;extc&quot;, instalar los discos supone apagar la máquina virtual y añadir los discos: 3 discos SCSI de 100 GiB cada uno y 1 disco SCSI de 500 GiB.</p>
<div class="section" id="ejercicio-1-instalando-los-discos">
<h2><a class="toc-backref" href="#id11">Ejercicio 1: Instalando los discos</a></h2>
<div class="admonition admonition-tareas-a-realizar">
<p class="first admonition-title">Tareas a realizar</p>
<ol class="last arabic simple">
<li>Parar &quot;extc&quot;.</li>
<li>Añadir los discos a la máquina virtual. (Se recomienda usar el <em>script</em> &quot;<a class="reference external" href="src/so-add-disk.sh">so-add-disk.sh</a>&quot;, explicado en la práctica anterior).</li>
<li>Poner en marcha &quot;extc&quot;.</li>
<li>Comprobar que han sido reconocidos los discos.</li>
</ol>
</div>
<div class="admonition admonition-material-a-entregar">
<p class="first admonition-title">Material a entregar</p>
<ol class="last arabic simple">
<li>Captura de pantalla mostrando la configuración del clon (deben aparecer los nuevos discos).</li>
<li>Salida de la orden &quot;lvmdiskscan&quot;.</li>
</ol>
</div>
</div>
</div>
<div class="section" id="trasladando-el-sf-home">
<h1><a class="toc-backref" href="#id12">Trasladando el SF &quot;/home&quot;</a></h1>
<p>El siguiente paso del caso realista consiste en crear el volumen lógico de 50 GiB &quot;lv_home&quot; y trasladar el SF &quot;/home&quot; a dicho LV (volumen lógico).</p>
<div class="admonition warning">
<p class="first admonition-title">Advertencia</p>
<p>A la hora de copiar &quot;/home&quot; con &quot;rsync&quot; hay que tener en cuenta que hay que copiar el contenido de &quot;/home&quot; en el nuevo sistema de ficheros (ej: &quot;/mnt/mnt&quot;) y no crear una carpeta &quot;home&quot; dentro de dicho sistema.</p>
<p class="last">Para comprobar que la copia ha sido correcta, tras la copia debe existir el directorio &quot;/mnt/mnt/user1&quot;.</p>
</div>
<div class="section" id="ejercicio-2-trasladando-home">
<h2><a class="toc-backref" href="#id13">Ejercicio 2: Trasladando &quot;/home&quot;</a></h2>
<div class="admonition admonition-tareas-a-realizar">
<p class="first admonition-title">Tareas a realizar</p>
<ol class="last arabic simple">
<li>Crear un grupo de volúmenes (&quot;vg1&quot;) que incluya todos los discos de 100 GiB (3 en total).</li>
<li>Crear en &quot;vg1&quot; el LV &quot;lv_home&quot; con un tamaño de 50 GiB.</li>
<li>Crear un SF en &quot;lv_home&quot; asignándole la etiqueta &quot;home&quot;.</li>
<li>Montarlo en una ubicación temporal (ej: &quot;/mnt/mnt&quot;).</li>
<li>Usar &quot;rsync&quot; para hacer una primera copia del SF (&quot;/home&quot;).</li>
<li>Cerrar la sesión de &quot;user1&quot; (entorno gráfico y terminal).</li>
<li>Entrar como usuario &quot;root&quot; usando la consola de texto 1.</li>
<li>Actualizar la copia.</li>
<li>Desmontar el SF del LV.</li>
<li>Renombrar &quot;/home&quot; como &quot;/home.orig&quot;.</li>
<li>Crear el directorio &quot;/home&quot;.</li>
<li>Editar &quot;/etc/fstab&quot; para que se monte el SF del LV en &quot;/home&quot;. (Sugerencia: usar la opción &quot;LABEL&quot; para seleccionar el dispositivo).</li>
<li>Ejecutar &quot;mount -a&quot; y comprobar que el nuevo SF está montado en &quot;/home&quot;.</li>
<li>Iniciar la sesión gráfica como &quot;user1&quot; y comprobar que la sesión gráfica se inicia normalmente.</li>
<li>Si todo ha ido bien, borrar el directorio &quot;/home.orig&quot;.</li>
</ol>
</div>
<div class="admonition admonition-material-a-entregar">
<p class="first admonition-title">Material a entregar</p>
<ol class="last arabic simple">
<li>Salida de la orden &quot;df -hT&quot;.</li>
<li>Salida de las órdenes &quot;pvs&quot;, &quot;vgs&quot; y &quot;lvs&quot;.</li>
</ol>
</div>
</div>
</div>
<div class="section" id="preparando-el-sf-para-datos">
<h1><a class="toc-backref" href="#id14">Preparando el SF para datos</a></h1>
<p>Para completar la configuración es necesario crear otro volumen lógico (&quot;lv_data&quot;) que ocupe todo el espacio libre de &quot;vg1&quot; y configurarlo para que se monte automáticamente.</p>
<div class="section" id="ejercicio-3-preparando-data">
<h2><a class="toc-backref" href="#id15">Ejercicio 3: Preparando &quot;data&quot;</a></h2>
<div class="admonition admonition-tareas-a-realizar">
<p class="first admonition-title">Tareas a realizar</p>
<ol class="last arabic simple">
<li>Crear en &quot;vg1&quot; el LV &quot;lv_data&quot; de forma que ocupe todo el espacio libre en el VG.</li>
<li>Crear un SF en &quot;lv_data&quot; asignándole la etiqueta &quot;data&quot;.</li>
<li>Editar &quot;/etc/fstab&quot; para que se monte el SF del LV en &quot;/mnt/data&quot; usando la opción &quot;LABEL&quot;.</li>
<li>Ejecutar &quot;mount -a&quot; y comprobar que el nuevo SF está montado en &quot;/mnt/data&quot;.</li>
<li>Crear el directorio &quot;/mnt/data/user1&quot;.</li>
<li>Estableder el dueño, el grupo y los permisos de forma que solamente &quot;user1&quot; pueda acceder a él.</li>
<li>Crear el enlace simbólico &quot;/home/user1/data&quot; de forma que apunte a &quot;/mnt/data/user1&quot;.</li>
<li>Comprobar que &quot;user1&quot; puede trabajar en &quot;/home/user1/data/&quot;.</li>
</ol>
</div>
<div class="admonition admonition-material-a-entregar">
<p class="first admonition-title">Material a entregar</p>
<ol class="last arabic simple">
<li>Salida de la orden &quot;df -hT&quot;.</li>
<li>Salida de las órdenes &quot;pvs&quot;, &quot;vgs&quot; y &quot;lvs&quot;.</li>
<li>Salida de la orden &quot;ls -la /home/user1/data{,/}&quot;</li>
</ol>
</div>
</div>
</div>
<div class="section" id="jugando-con-datos-y-copias-de-seguridad">
<h1><a class="toc-backref" href="#id16">Jugando con datos y copias de seguridad</a></h1>
<p>Un caso habitual cuando se desarrollan herramientas para el procesamiento de datos es tener que hacer repetidamente lo siguiente:</p>
<blockquote>
<ul class="simple">
<li>Generar un cierto conjunto de ficheros y directorios que, aunque cumpla con unos ciertos requisitos o siga determinados patrones, cambie cada vez. (El que cambie cada vez facilita detectar posibles de errores de programación).</li>
<li>Realizar copias de los datos de partida y/o los resultados.</li>
<li>Realizar pruebas de funcionamiento y volver rápidamente al estado inicial.</li>
</ul>
</blockquote>
<p>Durante este apartado se harán ejercicios que siguen este patrón y para ello se dispone de los siguientes programas:</p>
<blockquote>
<dl class="docutils">
<dt><a class="reference external" href="src/genera_listado.py">genera_listado.py</a></dt>
<dd><p class="first">Programa que genera un listado aleatorio de directorios, ficheros y contenido que se utilizará para realizar las pruebas. El programa genera el listado en la salida estándar. El listado es un fichero CSV con el siguiente formato:</p>
<ul class="simple">
<li>Cada línea es un registro con 3 campos: directorio, fichero, contenido para el fichero.</li>
<li>Los campos están separados entre sí por comas.</li>
<li>La primera línea es el encabezado.</li>
</ul>
<p>La forma de uso habitual será:</p>
<pre class="code literal-block">
./genera_listado.py &gt; listado.txt
</pre>
<p>Una  línea de ejemplo es:</p>
<pre class="code literal-block">
proceso,f0012,570d2de0b8df0e6cface5f51956c69bf90659964192e5cd28be7987464772620
</pre>
<p class="last">Donde &quot;proceso&quot; es la carpeta en la que debe residir el fichero &quot;f0012&quot;, cuyo contenido debe ser la cadena &quot;570d2de0b8df0e6cface5f51956c69bf90659964192e5cd28be7987464772620&quot;.</p>
</dd>
<dt>procesa_listado.sh</dt>
<dd>Guión para el intérprete de órdenes que debe haber sido desarrollado como trabajo previo. (Ver &quot;<a class="reference internal" href="#ejercicio-previo-3-script-para-preparar-datos-de-prueba">Ejercicio previo 3: script para preparar datos de prueba</a>&quot;).</dd>
<dt><a class="reference external" href="src/verifica_listado.sh">verifica_listado.sh</a></dt>
<dd><p class="first">Guión para el intérprete de órdenes que comprueba que el contenido del directorio actual es consistente con el listado que lee de la entrada estándar. Por ejemplo:</p>
<pre class="code last literal-block">
user1&#64;extc:~/lab8$ ./genera_listado.py &gt; listado.txt
user1&#64;extc:~/lab8$ mkdir pruebas
user1&#64;extc:~/lab8$ cd pruebas/
user1&#64;extc:~/lab8/pruebas$ ../procesa_listado.sh &lt; ../listado.txt
user1&#64;extc:~/lab8/pruebas$ ../verifica_listado.sh &lt; ../listado.txt
Comprobación correcta de 2500 ficheros :-)
user1&#64;extc:~/lab8/pruebas$
</pre>
</dd>
<dt><a class="reference external" href="src/hace_cambios.py">hace_cambios.py</a></dt>
<dd><p class="first">Programa que hace cambios en los ficheros y directorios de la carpeta actual. Por ejemplo:</p>
<pre class="code last literal-block">
user1&#64;extc:~/lab8/pruebas$ ../verifica_listado.sh &lt; ../listado.txt
Comprobación correcta de 2500 ficheros :-)
user1&#64;extc:~/lab8/pruebas$ ../hace_cambios.py
user1&#64;extc:~/lab8/pruebas$ ../verifica_listado.sh &lt; ../listado.txt
ERROR: No existe el directorio: NVM
:-(
user1&#64;extc:~/lab8/pruebas$
</pre>
</dd>
</dl>
</blockquote>
<div class="section" id="ejercicio-4-probando-mas-cosas-con-rsync">
<h2><a class="toc-backref" href="#id17">Ejercicio 4: probando más cosas con &quot;rsync&quot;</a></h2>
<p>En este ejercicio se añadirá un disco para copias de seguridad y se usará el programa &quot;rsync&quot; tanto para realizar copias de seguridad como para descartar los cambios realizados.</p>
<div class="admonition admonition-tareas-a-realizar">
<p class="first admonition-title">Tareas a realizar</p>
<ul class="last">
<li><p class="first">Usando el guión desarrollado en el ejercicio previo 3, rellenar &quot;/home/user1/data/ a partir de la lista de carpetas y ficheros generada por &quot;<a class="reference external" href="src/genera_listado.py">genera_listado.py</a>&quot;.</p>
</li>
<li><p class="first">Verificar la creación correcta del contenido usando el programa &quot;<a class="reference external" href="src/verifica_listado.sh">verifica_listado.sh</a>&quot;.</p>
</li>
<li><p class="first">Preparar el disco de 500 GiB para realizar copias de seguridad:</p>
<blockquote>
<ul class="simple">
<li>Se debe crear un VG denominado &quot;vg_bkup&quot; usando como PV el disco de 500 GiB.</li>
<li>Se debe crear un LV denominado &quot;lv_bkup&quot; que use todo el espacio disponible.</li>
<li>Se debe crear un sistema de ficheros EXT4 en él asignándole la etiqueta &quot;bkup&quot;.</li>
<li>El SF debe ser montado automáticamente en &quot;/mnt/bkup&quot; usando su etiqueta.</li>
<li>Debe existir la carpeta &quot;/mnt/bkup/user1&quot;, cuyo dueño y grupo debe ser &quot;user1.user1&quot;.</li>
</ul>
</blockquote>
</li>
<li><p class="first">El usuario &quot;user1&quot; debe tener un enlace simbólico denominado &quot;bkup&quot; que permita acceder a &quot;/mnt/bkup/user1&quot; usando la trayectoria &quot;/home/user1/bkup&quot;.</p>
</li>
<li><p class="first">Como &quot;user1&quot;, usando &quot;rsync&quot;, realizar una copia completa del contenido de &quot;/home/user1/data&quot; en &quot;/home/user1/bkup/data&quot;.</p>
<blockquote>
<ul class="simple">
<li><strong>Importante:</strong> es necesario comprobar que se copia el contenido de la carpeta a la que apunta el enlace simbólico, y no el enlace simbólico en sí.</li>
<li><em>Sugerencia:</em> usar &quot;/home/user1/data/&quot; como origen y poner &quot;data&quot; explícitamente en el destino.</li>
</ul>
</blockquote>
</li>
<li><p class="first">Verificar la creación correcta del contenido de la copia de seguridad usando el programa &quot;<a class="reference external" href="src/verifica_listado.sh">verifica_listado.sh</a>&quot;.</p>
</li>
<li><p class="first">Realizar cambios aleatorios en &quot;/home/user1/data/.&quot; usando el programa &quot;<a class="reference external" href="src/hace_cambios.py">hace_cambios.py</a>&quot;.</p>
</li>
<li><p class="first">Comprobar, usando el verificador, que &quot;/home/user1/data/.&quot; ya no pasa la verificación.</p>
</li>
<li><p class="first">Descartar los cambios realizados en &quot;/home/user1/data/.&quot; usando &quot;rsync&quot; y la copia de seguridad realizada previamente.</p>
</li>
</ul>
</div>
<div class="admonition admonition-material-a-entregar">
<p class="first admonition-title">Material a entregar</p>
<ul class="last">
<li><p class="first">Salida de las siguientes órdenes:</p>
<pre class="literal-block">
df -hT /mnt/bkup
ls -l /home/user/data/.
ls -l /home/user1/bkup/data
ls -l /home/user1
pvs
vgs
lvs
</pre>
</li>
<li><p class="first">Copia de la orden completa para realizar la copia de seguridad.</p>
</li>
<li><p class="first">Copia de la orden completa para descartar los cambios.</p>
</li>
</ul>
</div>
</div>
<div class="section" id="ejercicio-opcional-1-usando-snapshots">
<h2><a class="toc-backref" href="#id18">Ejercicio opcional 1: usando <em>snapshots</em></a></h2>
<p>Suponiendo que no se desea usar el disco de copias de seguridad cada vez que se hace una prueba, realizar las siguientes acciones utilizando <em>snapshots</em> del volúmen lógico &quot;data&quot;, teniendo en cuenta que la gestión del volúmen lógico se debe hacer como administrador del sistema.</p>
<ul class="simple">
<li>Verificar que el contenido de &quot;/home/user1/data/.&quot; es correcto usando el programa &quot;<a class="reference external" href="src/verifica_listado.sh">verifica_listado.sh</a>&quot;.</li>
<li>Preparar el volumen lógico &quot;data&quot; para las pruebas.</li>
<li>Verificar que el contenido de &quot;/home/user1/data/.&quot; es correcto usando el programa &quot;<a class="reference external" href="src/verifica_listado.sh">verifica_listado.sh</a>&quot;.</li>
<li>Realizar cambios aleatorios en &quot;/home/user1/data/.&quot; usando el programa &quot;<a class="reference external" href="src/hace_cambios.py">hace_cambios.py</a>&quot;.</li>
<li>Comprobar, usando el verificador, que &quot;/home/user1/data/.&quot; ya no pasa la verificación.</li>
<li>Descartar los cambios realizados en el volumen lógico &quot;data&quot;.</li>
<li>Verificar que el contenido de &quot;/home/user1/data/.&quot; vuelve a ser correcto.</li>
</ul>
<div class="admonition admonition-tareas-a-realizar">
<p class="first admonition-title">Tareas a realizar</p>
<ul class="last simple">
<li>Preparar las órdenes de gestión de volúmenes lógicos necesarias para el ejercicio. (Téngase en cuenta que el grupo de volúmenes &quot;vg1&quot; no tendrá espacio libre para nuevos volúmenes lógicos).</li>
<li>Realizar las acciones descritas.</li>
</ul>
</div>
<div class="admonition admonition-material-a-entregar">
<p class="first admonition-title">Material a entregar</p>
<ul class="last simple">
<li>Explicación de las órdenes utilizadas para las gestión del volumen lógico &quot;data&quot;.</li>
</ul>
</div>
</div>
</div>
</div>
</body>
</html>
